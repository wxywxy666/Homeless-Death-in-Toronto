<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Xiyou Wang">
<meta name="dcterms.date" content="2024-01-24">

<title>Investigating the Cause of Homeless People’s Deaths in Toronto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="paper_files/libs/quarto-html/quarto.js"></script>
<script src="paper_files/libs/quarto-html/popper.min.js"></script>
<script src="paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="paper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="paper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#causes-of-death-among-homeless-people-in-toronto" id="toc-causes-of-death-among-homeless-people-in-toronto" class="nav-link" data-scroll-target="#causes-of-death-among-homeless-people-in-toronto">Causes of Death among Homeless People in Toronto</a></li>
  <li><a href="#the-age-groups-of-homeless-people-who-died-in-toronto" id="toc-the-age-groups-of-homeless-people-who-died-in-toronto" class="nav-link" data-scroll-target="#the-age-groups-of-homeless-people-who-died-in-toronto">The Age Groups of Homeless People Who Died in Toronto</a></li>
  <li><a href="#the-gender-of-homeless-people-who-died-in-toronto" id="toc-the-gender-of-homeless-people-who-died-in-toronto" class="nav-link" data-scroll-target="#the-gender-of-homeless-people-who-died-in-toronto">The Gender of Homeless People Who Died in Toronto</a></li>
  <li><a href="#cause-of-death-distributed-by-year" id="toc-cause-of-death-distributed-by-year" class="nav-link" data-scroll-target="#cause-of-death-distributed-by-year">Cause of Death Distributed by Year</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Investigating the Cause of Homeless People’s Deaths in Toronto</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Xiyou Wang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 24, 2024</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    The death of homeless people in Toronto can be a concerning issue considering that they are already vulnerable because of their homelessness and thus exposed to very many dangers. Many factors contribute to the death of the homeless people in Toronto. This report aims to investigate the causes of death of homeless people in Toronto from 2017 to 2023. The study shows that drugs and toxicity are the leading causes of death among homeless people in Toronto. Covid-19 also had severe effects on the deaths of the homeless in Toronto. This finding suggests that drugs and toxicity should be handled with the highest swiftness in dealing with the deaths of homeless people in Toronto. The long-term effects of the pandemic on the life of the homeless in Toronto should also be investigated as the relevant stakeholders including the government take the appropriate measures to protect the lives of these vulnerable individuals.
  </div>
</div>

</header>

<div style="page-break-after: always;"></div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>As one of the busiest and most modern cities in Canada, Toronto constantly hosts a large number of homeless people. As one of the cities in Canada with high standards, Toronto faces a growing homeless population. Reasons for homelessness are varied and can be a web of issues that include joblessness, mental health problems, addiction; family splits as well shortage of affordable housing. Homeless individuals have one of the greatest levels of vulnerability since they do not have any form of proper sheltering for their protection. Some of the most common causes of death among the homeless have been determined to be drug addiction. Despite their homeless conditions the death of the homeless still contributes excruciating pain to the families and a loss to the country <span class="citation" data-cites="cite10">(<a href="#ref-cite10" role="doc-biblioref">Canada 2023</a>)</span>.</p>
<p>Toronto Public Health published data that showed that drugs and toxicity which often come from the unregulated supply in the city are two of the leading causes of deaths of the homeless in Toronto <span class="citation" data-cites="cite13">(<a href="#ref-cite13" role="doc-biblioref">Toronto 2023</a>)</span>. With the help of statistical data analysis, it can offer insights on the ways to reduce this type of death of these vulnerable members of the Toronto society. This report investigates the homeless deaths in Toronto from 2017 to 2023. Then I discussed the possible implications of these visualizations. Table 1 shows that there were different causes of death of the homeless between 2017 and 2023. In Figure 1, a comparative analysis of the causes of death for each age group was explored. In Figure 2, I discussed about the distribution of death from males and females. About the The result from the datasets indicates that there were different causes of death including suicide and undetermined causes. However, as the Figure 3 shows, drug and toxicity was the leading cause of the deaths of homeless individuals in Toronto. More implications and further discussions on this result are presented in Discussion Section.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<section id="causes-of-death-among-homeless-people-in-toronto" class="level2">
<h2 class="anchored" data-anchor-id="causes-of-death-among-homeless-people-in-toronto">Causes of Death among Homeless People in Toronto</h2>
<p>To investigate the cause of death of homeless individuals in Toronto, I obtained the dataset from the Toronto Open Data Portal <span class="citation" data-cites="cite6">(<a href="#ref-cite6" role="doc-biblioref">Gelfand 2022</a>)</span>. Provided by the Toronto Public Health, this dataset includes all causes of death of the homeless which occurred in Toronto between 2017 and 2023. For ethical reasons and the protection of the parties involved in the deaths, none of their personal information was disclosed.</p>
<p>This dataset contains 253 observations of death, noticing that one observation could contain more than one death, 6 variables regarding id, year of death, cause of death, gender, age group, and count. This report focuses on 5 of these variables except id. By using R <span class="citation" data-cites="cite1">(<a href="#ref-cite1" role="doc-biblioref">R Core Team 2023</a>)</span>, and R packages “janitor” <span class="citation" data-cites="cite2">(<a href="#ref-cite2" role="doc-biblioref">Firke 2023</a>)</span>, “tidyverse” <span class="citation" data-cites="cite3">(<a href="#ref-cite3" role="doc-biblioref">Wickham et al. 2019</a>)</span>, “knitr” <span class="citation" data-cites="cite4">(<a href="#ref-cite4" role="doc-biblioref">Xie 2023</a>)</span>, and “kableExtra” <span class="citation" data-cites="cite5">(<a href="#ref-cite5" role="doc-biblioref">Zhu 2021</a>)</span>, an extract of the cleaned dataset is shown below.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Count of Death Arranged by Cause</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Cause_of_death</th>
<th style="text-align: right;">Count of Death</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accident</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td style="text-align: left;">COVID-19</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cancer</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cardiovascular Disease</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug Toxicity</td>
<td style="text-align: right;">432</td>
</tr>
<tr class="even">
<td style="text-align: left;">Homicide</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: right;">56</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pneumonia</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Suicide</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unknown/Pending</td>
<td style="text-align: right;">208</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Table 1 shows the total count of each cause of death. Variable “Cause_of_death” indicates that different causes of homeless people’s death, including “Accident”, “Cancer” ,etc. Variable “Count of Death” indicates the total count of death under this cause.</p>
<p>First, I want to conduct research on the causes of death, so I will not discuss variables such as age and year of death for the time being. Using this table, I can find that the number of deaths due to drug toxicity is significantly higher than other causes. In addition, as of today, there are still 208 cases of unknown death. It is not easy to comprehensively relieve these homeless people. Steer notes that if a death is considered “natural,” and the coroner is not involved <span class="citation" data-cites="cite14">(<a href="#ref-cite14" role="doc-biblioref">Webster 2017</a>)</span>.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="the-age-groups-of-homeless-people-who-died-in-toronto" class="level2">
<h2 class="anchored" data-anchor-id="the-age-groups-of-homeless-people-who-died-in-toronto">The Age Groups of Homeless People Who Died in Toronto</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="paper_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Comparing the count of death by different age groups from 2017 to 2023</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure 1 shows the number of homeless people dying by age from 2017 to 2023. We can find that most of the people who died are concentrated in the 40-59 range, the second largest age group is 60+, and only a small number of young people under the age of 20 died. But this is not something to be thankful for, every death is a tragedy, especially for those young children. It’s really, really unfair when someone dies an avoidable death as a teenager <span class="citation" data-cites="cite11">(<a href="#ref-cite11" role="doc-biblioref">Reporter 2023</a>)</span>. It can be seen that survival will be particularly difficult for middle-aged and elderly homeless people. Considering their declining physical capabilities and Toronto’s cold winters <span class="citation" data-cites="cite12">(<a href="#ref-cite12" role="doc-biblioref">Romaszko et al. 2017</a>)</span>, the government should give them more help.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="the-gender-of-homeless-people-who-died-in-toronto" class="level2">
<h2 class="anchored" data-anchor-id="the-gender-of-homeless-people-who-died-in-toronto">The Gender of Homeless People Who Died in Toronto</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="paper_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Comparing the count of death by different genders from 2017 to 2023</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure 2 shows the difference in the number of deaths by gender, as well as the specific number of deaths among men and women. From this we can conclude that female deaths account for approximately 21.707%, but this does not mean that the health status of female homeless people is worse. Good, because the total number of homeless men is greater than that of women, accounting for about 63% <span class="citation" data-cites="cite7">(<a href="#ref-cite7" role="doc-biblioref">Homeless 2021</a>)</span>of the total.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="cause-of-death-distributed-by-year" class="level2">
<h2 class="anchored" data-anchor-id="cause-of-death-distributed-by-year">Cause of Death Distributed by Year</h2>
<p>Before conducting further research, I have been interested in the impact of covid on the homeless. I previously thought that a large number of homeless people would die from covid, but Table 1 already shows the death toll. , which is far lower than my guess. I hope to have a deeper understanding of this phenomenon.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="paper_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Comparing the count of death by different years from 2017 to 2023</figcaption>
</figure>
</div>
</div>
</div>
<p>Figure 3 shows the annual death toll statistics from 2017 to 2013. It can be found that the overall number is increasing, reaching a peak in 2021, and then declining. In the covid epidemic, direct deaths from covid only exist from 2020 to 2022, and the number is far less than I guessed. But in fact, the impact of the epidemic is not limited to this. First of all, being infected with covid does not necessarily lead to death, but the subsequent sequelae, such as increasing the probability of cardiovascular disease and weakening lung function, will indirectly affect the health of homeless people, and often they do not have the conditions to go Get some effective diagnosis and treatment. In addition, under the conditions of the epidemic, the increase in the number of homeless people has also led to a shortage of social facilities, which has also made the situation of homeless people even worse <span class="citation" data-cites="cite8">(<a href="#ref-cite8" role="doc-biblioref">Baral et al. 2021</a>)</span>.</p>
<p>I have also observed that the main reason for the increase in the death toll is the sharp increase in deaths and injuries caused by drug toxicity. A large portion of drug toxicity deaths stem from the toxic, unregulated drug supply. The use of highly potent opioids combined with unexpected substances is significantly increasing the risk of overdose in Toronto,” the city said in a Sept.&nbsp;28 news release. These deaths are an example of the negative health impacts of the ongoing drug toxicity crisis.” Dr.&nbsp;Eileen de Villa, Toronto’s medical officer of health, pointed to “notable increases” in the number of unhoused people dying in the city during the pandemic <span class="citation" data-cites="cite9">(<a href="#ref-cite9" role="doc-biblioref">Joanna 2023</a>)</span>.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>The analyzed data on death causes among homeless people in Toronto show obvious patterns and trends. Although the exact numbers and counts are not given, the percentages and distributions help in generating an understanding of what challenges homeless folks face today with possible impacts on public health policy. An examination of the results in Figure 3 shows that the drug and toxicity were the leading cause of death of the homeless in all the years. Cardiovascular death is the main cause of mortality among homeless people, accounting for a significant proportion of overall deaths. It is, therefore, important to tackle these underlying health concerns that affect the homeless population for enhanced general well-being. Among the most notable outcomes is that deaths caused by drug toxicity are widespread. This category is a particularly significant contributor to homeless mortality, highlighting problems with substance abuse within this group. These implications far exceed just health concerns because addiction, mental health, and the availability of rehab are also involved. This result alerts us about the safety and security of homeless people, they are at risk out there in public places. Policymakers and social services should address these safety concerns so that a healthy environment is created for the homeless to ensure their security. A significant decrease in mortality rates could be achieved by initiatives related to preventive care, health screenings, and substance abuse treatment. Cooperation of health care providers and shelters will enable the homeless to obtain appropriate, timely medical care for chronic disorders.</p>
<p>The findings showcase the complicated connection between housing stability and health outcomes. Some of the difficulties associated with homelessness feed into cardiovascular diseases, drug toxicity, and other health problems. Affordable housing solutions and housing supportive programs should therefore be financed to directly address the causes of these health inequalities. The high prevalence of drug intoxication underscores the urgent need for mental health and substance abuse support services. Customized interventions such as counseling, addiction treatment, and harm reduction strategies are a cornerstone to reducing mortality for homeless who abuse substances. Homicide as a cause of death requires attention to safety measures and community integration. Since policies encourage secure environments, action against violence and effective community policing can ensure a safer environment for the homeless. Furthermore, initiatives aimed at introducing homeless people to the community through job and social services can improve their quality of life. Measures should be taken to reduce the rates of drug abuse among the homeless in Toronto. The government and other NGOs could come up with programs that help not only in housing them and increasing security to reduce the homicidal cases among them to also to rehabilitate them, from drugs and toxic substances WHO and the Public Health of Toronto must further study the issues. After the impact, how to re-improve social security measures is also an issue worthy of serious consideration.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-cite8" class="csl-entry" role="listitem">
Baral, Stefan, Andrew Bond, Andrew Boozary, Eva Bruketa, Nika Elmi, Deirdre Freiheit, S. Monty Ghosh, et al. 2021. <em>Seeking Shelter: Homelessness and Covid-19</em>. <a href="https://www.facetsjournal.com/doi/10.1139/facets-2021-0004">https://www.facetsjournal.com/doi/10.1139/facets-2021-0004</a>.
</div>
<div id="ref-cite10" class="csl-entry" role="listitem">
Canada, CBC/Radio. 2023. <em>City Data Shows 110 Unhoused People Died Last Year in Toronto Homeless Shelters</em>. <a href="https://www.cbc.ca/news/canada/toronto/deaths-of-shelter-residents-2022-toronto-1.6721890">https://www.cbc.ca/news/canada/toronto/deaths-of-shelter-residents-2022-toronto-1.6721890</a>.
</div>
<div id="ref-cite2" class="csl-entry" role="listitem">
Firke, Sam. 2023. <em>Janitor: Simple Tools for Examining and Cleaning Dirty Data</em>. <a href="https://github.com/sfirke/janitor">https://github.com/sfirke/janitor</a>.
</div>
<div id="ref-cite6" class="csl-entry" role="listitem">
Gelfand, Sharla. 2022. <em>Opendatatoronto: Access the City of Toronto Open Data Portal</em>. <a href="https://sharlagelfand.github.io/opendatatoronto/">https://sharlagelfand.github.io/opendatatoronto/</a>.
</div>
<div id="ref-cite7" class="csl-entry" role="listitem">
Homeless, Canadian Observatory on. 2021. <em>Toronto | the Homeless Hub</em>. <a href="https://www.homelesshub.ca/community-profile/toronto">https://www.homelesshub.ca/community-profile/toronto</a>.
</div>
<div id="ref-cite9" class="csl-entry" role="listitem">
Joanna, Lavoie. 2023. <em>Deaths Among Toronto’s Unhoused People Still Trending High with Drug Toxicity Crisis to Blame</em>. <a href="https://toronto.ctvnews.ca/deaths-among-toronto-s-unhoused-people-still-trending-high-with-drug-toxicity-crisis-to-blame-1.6582282">https://toronto.ctvnews.ca/deaths-among-toronto-s-unhoused-people-still-trending-high-with-drug-toxicity-crisis-to-blame-1.6582282</a>.
</div>
<div id="ref-cite1" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-cite11" class="csl-entry" role="listitem">
Reporter, Victoria Gibson Affordable Housing. 2023. <em>In Toronto, More Than Three Homeless People Died on Average Every Week Last Year, New Data Shows</em>. <a href="https://www.thestar.com/news/gta/in-toronto-more-than-three-homeless-people-died-on-average-every-week-last-year-new/article_87fa515b-f774-5161-bba7-266b788a5572.html">https://www.thestar.com/news/gta/in-toronto-more-than-three-homeless-people-died-on-average-every-week-last-year-new/article_87fa515b-f774-5161-bba7-266b788a5572.html</a>.
</div>
<div id="ref-cite12" class="csl-entry" role="listitem">
Romaszko, Jerzy, Iwona Cymes, Ewa Dragańska, Robert Kuchta, and Katarzyna Glińska-Lewczuk. 2017. <em>Mortality Among the Homeless: Causes and Meteorological Relationships</em>. <a href="https://journals.plos.org/plosone/article?id=10.1371%2Fjournal.pone.0189938">https://journals.plos.org/plosone/article?id=10.1371%2Fjournal.pone.0189938</a>.
</div>
<div id="ref-cite13" class="csl-entry" role="listitem">
Toronto, City of. 2023. <em>Toronto Public Health Releases 2022 Data for Deaths of People Experiencing Homelessness</em>. <a href="https://www.toronto.ca/news/toronto-public-health-releases-2022-data-for-deaths-of-people-experiencing-homelessness/">https://www.toronto.ca/news/toronto-public-health-releases-2022-data-for-deaths-of-people-experiencing-homelessness/</a>.
</div>
<div id="ref-cite14" class="csl-entry" role="listitem">
Webster, Paul. 2017. <em>Bringing Homeless Deaths to Light</em>. <a href="https://doi.org/10.1503/cmaj.1095399">https://doi.org/10.1503/cmaj.1095399</a>.
</div>
<div id="ref-cite3" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-cite4" class="csl-entry" role="listitem">
Xie, Yihui. 2023. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in r</em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-cite5" class="csl-entry" role="listitem">
Zhu, Hao. 2021. <em>kableExtra: Construct Complex Table with ’Kable’ and Pipe Syntax</em>. <a href="http://haozhu233.github.io/kableExtra/">http://haozhu233.github.io/kableExtra/</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>